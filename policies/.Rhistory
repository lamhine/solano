c("Benicia city|Dixon city|Rio Vista city|Vallejo city|Suisun City city|Fairfield city|Vacaville city")
)
) %>%
mutate(
PlaceName = str_remove(
NAME,
" city, California"
)
) %>%
select(-NAME)
# create map base layer
map <- geo_outline %>%
ggplot(aes(fill = estimate)) +
geom_sf(color = "black", fill = NA, lwd = 1)
map
# create map base layer
map <- geo_outline %>%
ggplot(aes(fill = estimate)) +
geom_sf(color = "black", fill = NA, lwd = 1) +
remove_grid
# create map base layer
map <- geo_outline %>%
ggplot(aes(fill = estimate)) +
geom_sf(color = "black", fill = NA, lwd = 1) +
theme_void()
map
geo_place <- get_acs(
geography = "place",
variables = "B19013_001", #just pull income from ACS to get polygon
state = "06",
year = 2020,
geometry = TRUE
) %>%
filter(
str_detect(
NAME,
c("Benicia city|Dixon city|Rio Vista city|Vallejo city|Suisun City city|Fairfield city|Vacaville city")
)
) %>%
mutate(
NAME = str_remove(
NAME,
" city, California"
)
) %>%
select(-NAME)
geo_place <- get_acs(
geography = "place",
variables = "B19013_001", #just pull income from ACS to get polygon
state = "06",
year = 2020,
geometry = TRUE
) %>%
filter(
str_detect(
NAME,
c("Benicia city|Dixon city|Rio Vista city|Vallejo city|Suisun City city|Fairfield city|Vacaville city")
)
)
geo_place <- get_acs(
geography = "place",
variables = "B19013_001", #just pull income from ACS to get polygon
state = "06",
year = 2020,
geometry = TRUE
) %>%
filter(
str_detect(
NAME,
c("Benicia city|Dixon city|Rio Vista city|Vallejo city|Suisun City city|Fairfield city|Vacaville city")
)
) %>%
mutate(
NAME = str_remove(
NAME,
" city, California"
)
)
# create map base layer
map <- geo_outline %>%
ggplot(aes(fill = estimate)) +
geom_sf(color = "black", fill = NA, lwd = 1) +
geom_sf_text(data = geo_place, aes(label = NAME))
map
# create map base layer
map <- geo_outline %>%
ggplot(aes(fill = estimate)) +
geom_sf(color = "black", fill = NA, lwd = 1) +
geom_sf_text(data = geo_place, aes(label = NAME)) +
theme_void()
map
map + geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
labs(fill = "Structural Racism Scale")
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
labs(fill = "Structural Racism Scale")
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums))
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
labs(fill = "Structural Racism Scale")
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
geom_sf_text(data = geo_place, aes(label = NAME)) +
labs(fill = "Structural Racism Scale")
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
labs(fill = "Structural Racism Scale")
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
geom_sf_text(data = geo_place, aes(label = NAME)) +
labs(fill = "Structural Racism Scale")
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
labs(fill = "Structural Racism Scale")
# get polygon data for solano county places
geo_place <- get_acs(
geography = "place",
variables = "B19013_001", #just pull income from ACS to get polygon
state = "06",
year = 2020,
geometry = TRUE
) %>%
filter(
str_detect(
NAME,
c("Benicia city|Dixon city|Rio Vista city|Vallejo city|Suisun City city|Fairfield city|Vacaville city")
)
) %>%
mutate(
PlaceName = str_remove(
NAME,
" city, California"
)
) %>%
select(-NAME)
# replace income data with policy index
geo_place <- left_join(
geo_place,
distinct(
sr_tracts, PlaceName, index
)
) %>%
select(-estimate)
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1)
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1) +
geom_sf_text(aes(label = PlaceName))
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1) +
geom_sf_text(aes(label = PlaceName))
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1) +
geom_sf_text(aes(label = PlaceName)) +
labs(fill = "Policy Progressiveness Index")
library(ggrepel)
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1) +
ggrepel::geom_label_repel(aes(label = PlaceName), stat = "sf_coordinates") +
labs(fill = "Policy Progressiveness Index")
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1) +
ggrepel::geom_label_repel(aes(label = PlaceName, geometry = geometry),
stat = "sf_coordinates") +
labs(fill = "Policy Progressiveness Index")
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1) +
ggrepel::geom_label_repel(aes(label = PlaceName, fill = "white", geometry = geometry),
stat = "sf_coordinates") +
labs(fill = "Policy Progressiveness Index")
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1) +
ggrepel::geom_label_repel(aes(label = PlaceName, geometry = geometry),
stat = "sf_coordinates") +
labs(fill = "Policy Progressiveness Index")
# get polygon data for solano county places
geo_place <- get_acs(
geography = "place",
variables = "B19013_001", #just pull income from ACS to get polygon
state = "06",
year = 2020,
geometry = TRUE
) %>%
filter(
str_detect(
NAME,
c("Benicia city|Dixon city|Rio Vista city|Vallejo city|Suisun City city|Fairfield city|Vacaville city")
)
) %>%
mutate(
PlaceName = str_remove(
NAME,
" city, California"
)
) %>%
select(-NAME)
# replace income data with policy index
geo_place <- left_join(
geo_place,
distinct(
sr_tracts, PlaceName, index
)
) %>%
select(-estimate)
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = sc_shp, color = "black", fill = NA, lwd = 1) +
geom_sf_text(aes(label = PlaceName)) +
labs(fill = "Policy Progressiveness Index")
View(sc_shp)
View(geo_outline)
geo_place %>%
ggplot(aes(fill = index)) +
geom_sf(color = NA) +
scale_fill_viridis_c() +
theme_void() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
geom_sf_text(aes(label = PlaceName)) +
labs(fill = "Policy Progressiveness Index")
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
labs(fill = "Structural Racism Scale")
# get polygon data for solano county tracts
geo_tracts <- get_acs(
geography = "tract",
variables = "B19013_001", #just pull income from ACS to get polygon
state = "06",
county = "Solano",
year = 2022,
geometry = TRUE
)
# replace income data with SR scores
geo_tracts <- left_join(
geo_tracts,
select(
sr_tracts, GEOID, dim_sums
)
) %>%
select(-estimate)
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
labs(fill = "Structural Racism Scale")
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
geom_sf_text(data = geo_place, aes(label = PlaceName)) +
labs(fill = "Structural Racism Scale")
ggplot(data = geo_tracts, aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
geom_sf_text(data = geo_place, aes(label = PlaceName)) +
labs(fill = "Structural Racism Scale")
geo_tracts %>%
ggplot(aes(fill = dim_sums)) +
geom_sf(color = NA) +
scale_fill_viridis_c(option = "magma") +
theme_void() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
geom_sf_text(data = geo_place, aes(label = PlaceName)) +
labs(fill = "Structural Racism Scale")
map <- ggplot() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
geom_sf_text(data = geo_place, aes(label = NAME)) +
theme_void()
map
# create map base layer
map <- ggplot() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
geom_sf_text(data = geo_place, aes(label = PlaceName)) +
theme_void()
map
map <- ggplot() +
geom_sf(data = geo_outline, color = "black", fill = NA, lwd = 1) +
#geom_sf_text(data = geo_place, aes(label = PlaceName)) +
theme_void()
map
map
map +
geom_sf(data = geo_tracts, fill = dim_sums)
View(geo_tracts)
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums))
map
map +
geom_sf(data = geo_tracts, fill = dim_sums)
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums))
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_sf_text(data = geo_place, aes(label = PlaceName, colour = "White"))
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_sf_text(data = geo_place, aes(label = PlaceName, colour = "White"))
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_sf_text(data = geo_place, aes(label = PlaceName))
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_sf_text(data = geo_place, aes(label = PlaceName), color = "White")
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_sf_text(data = geo_place, aes(label = PlaceName), color = "White")
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_sf_text(data = geo_place, aes(label = PlaceName), color = "Grey")
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_sf_text(data = geo_place, aes(label = PlaceName), color = "Grey")  +
labs(fill = "Structural Racism Scale")
# get polygon data for solano county places
geo_place <- get_acs(
geography = "place",
variables = "B19013_001", #just pull income from ACS to get polygon
state = "06",
year = 2020,
geometry = TRUE
) %>%
filter(
str_detect(
NAME,
c("Benicia city|Dixon city|Rio Vista city|Vallejo city|Suisun City city|Fairfield city|Vacaville city")
)
) %>%
mutate(
PlaceName = str_remove(
NAME,
" city, California"
)
) %>%
select(-NAME)
# replace income data with policy index
geo_place <- left_join(
geo_place,
distinct(
sr_tracts, PlaceName, index
)
) %>%
select(-estimate) %>%
rename(NAME = PlaceName)
map +
geom_sf(data = geo_place, aes(fill = index)) +
geom_sf_text(data = geo_place, aes(label = PlaceName), color = "Grey")  +
labs(fill = "Policy Progressiveness Index")
map +
geom_sf(data = geo_place, aes(fill = index)) +
geom_sf_text(data = geo_place, aes(label = NAME), color = "Grey")  +
labs(fill = "Policy Progressiveness Index")
map +
geom_sf(data = geo_place, aes(fill = index)) +
geom_sf_label(data = geo_place, aes(label = NAME), color = "Grey")  +
labs(fill = "Policy Progressiveness Index")
map +
geom_sf(data = geo_place, aes(fill = index)) +
geom_sf_label(data = geo_place, aes(label = NAME))  +
labs(fill = "Policy Progressiveness Index")
map +
geom_sf(data = geo_place, aes(fill = index)) +
geom_label_repel(
data = geo_place,
aes(label = NAME,
geometry = geometry),
stat = "sf_coordinates"
)  +
labs(fill = "Policy Progressiveness Index")
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_label_repel(
data = geo_place,
aes(label = NAME,
geometry = geometry),
stat = "sf_coordinates"
)  +
labs(fill = "Structural Racism Scale")
summary(mod_lmer)
map +
geom_sf(data = geo_tracts, aes(fill = dim_sums)) +
geom_label_repel(
data = geo_place,
aes(label = NAME,
geometry = geometry),
stat = "sf_coordinates"
)  +
labs(fill = "Structural Racism Scale")
map +
geom_sf(data = geo_place, aes(fill = index)) +
geom_label_repel(
data = geo_place,
aes(label = NAME,
geometry = geometry),
stat = "sf_coordinates"
)  +
labs(fill = "Policy Progressiveness Index")
View(pol_summ)
View(df_policies)
sr_tracts %>% group_by(PlaceName) %>% summarize(mean = mean(dim_sums))
get_acs(
geography = "tract",
variables = "B01003_001",
state = "CA",
county = "Solano",
year = 2022,
survey = "acs5",
geometry = F
)
pops<-get_acs(
geography = "tract",
variables = "B01003_001",
state = "CA",
county = "Solano",
year = 2022,
survey = "acs5",
geometry = F
)
avgs <- left_join(sr_tracts, pops)
View(pops)
View(avgs)
avgs <- avgs %>% mutate(sumprod = dim_sums * estimate)
tot_pops<- avgs %>% group_by(PlaceName) %>% sumamrize(tot_pop = sum(estimate))
tot_pops<- avgs %>% group_by(PlaceName) %>% summarize(tot_pop = sum(estimate))
View(tot_pops)
avgs <- avgs %>% left_join(avgs, tot_pops)
avgs <- avgs %>% left_join(avgs, tot_pops, by = "PlaceName")
avgs <- left_join(sr_tracts, pops)
avgs <- avgs %>% mutate(sumprod = dim_sums * estimate)
avgs <- avgs %>% left_join(tot_pops)
avgs <- avgs %>% mutate(weighted = sumprod/tot_pop)
avgs %>% group_by(PlaceName) %>% summarize(weighted_mean = mean(weighted))
tidy(mod_lmer)
augment(mod_lmer)
tidy(mod_lmer, conf.int = T)
map +
geom_sf(
data = geo_tracts,
aes(fill = dim_sums),
scale_fill_viridis_c(option = "magma")
) +
geom_label_repel(
data = geo_place,
aes(label = NAME,
geometry = geometry),
stat = "sf_coordinates"
)  +
labs(fill = "Structural Racism Scale")
